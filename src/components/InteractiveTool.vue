<template>
  <svg id="canvas" ref="canvas" xmlns="http://www.w3.org/2000/svg" viewBox="-10 0 1720 1126.84">
    <g id="main-elements">
      <circle id="inner" cx="842.51" cy="516.07" r="346.94" style="fill: #e7e7e9;stroke: #8f9194;stroke-miterlimit: 10;stroke-width: 3px"/>
      <circle id="outer" cx="842.51" cy="516.07" r="412.86"/>
    </g><!-- main-elements -->

    <g id="arrow" ref="arrow">
      <polygon ref="arrowShape" points="842.64 1016.57 851 1031.03 859.35 1045.5 842.64 1045.5 825.94 1045.5 834.29 1031.03 842.64 1016.57"/>
      <circle id="arrow-path" cx="842.51" cy="516.07" r="516.07" style="fill: none"/>
    </g><!-- arrow -->

    <g id="risk-options">
      <g class="risk low">
        <path class="bg" d="M596.83,662.9A423,423,0,0,1,563.4,503.31h-56A480.62,480.62,0,0,0,648.57,838a487.39,487.39,0,0,0,36.51,33l34.19-44.39q-16.15-13.27-31.1-28.21A424.76,424.76,0,0,1,596.83,662.9Z" transform="translate(-146.99 19.03)"/>
        <g class="text">
          <path d="M564.07,630.55l.88,2.76-10.52,3.39,1.76,5.48-2.42.78-2.66-8.23Z" transform="translate(-146.99 19.03)"/>
          <path d="M570.35,648.52a7,7,0,1,1-9-4.3A6.83,6.83,0,0,1,570.35,648.52Zm-2.41.87c-.85-2.36-3.2-3.23-5.6-2.37s-3.66,3-2.81,5.39a4.15,4.15,0,0,0,5.61,2.39C567.54,653.93,568.79,651.75,567.94,649.39Z" transform="translate(-146.99 19.03)"/>
          <path d="M573.08,668.1l-9.54,1.35-1.17-2.85,11.12-8.76,1.23,3-8.2,5.93,10.08-1.32.86,2.09-8.13,6.11,10-1.54,1.24,3L566.5,676.7l-1.16-2.85Z" transform="translate(-146.99 19.03)"/>
          <path d="M579.68,694l-.92-1.92-4.4,2.11-1.25-2.61,12.27-5.89,2.75,5.74a4.24,4.24,0,0,1-2,6,3.9,3.9,0,0,1-4.93-.94l-3.35,5-1.44-3Zm6-1.88-1.31-2.74L581,691l1.32,2.73a1.88,1.88,0,1,0,3.38-1.62Z" transform="translate(-146.99 19.03)"/>
          <path d="M592.26,699.72l1.32,2.58-12.11,6.22-1.32-2.58Z" transform="translate(-146.99 19.03)"/>
          <path d="M588,712.08a6,6,0,0,0,.46,4.68c.76,1.39,1.8,1.71,2.48,1.34.89-.49.63-1.69.2-3.25-.62-2.2-1.45-5,1.22-6.45,2-1.09,4.54-.25,6.07,2.56a7.55,7.55,0,0,1,.88,5.57l-2.64-.4a5.75,5.75,0,0,0-.56-4.13c-.62-1.15-1.46-1.49-2.17-1.1s-.51,1.59-.08,3.14c.63,2.21,1.41,5.05-1.25,6.49-2.18,1.19-4.68.54-6.44-2.69a7.85,7.85,0,0,1-.87-6.1Z" transform="translate(-146.99 19.03)"/>
          <path d="M598.09,727.37l-1.63-.27-3.6,2.13-1.47-2.49,11.72-6.93,1.47,2.49-5.23,3.1,7.68,1.05,1.82,3.07-8.25-1.4-3.28,8.65-1.82-3.08Z" transform="translate(-146.99 19.03)"/>
        </g>
      </g>
      <g class="risk intermediate">
        <path class="bg" d="M1240.56,841.41a425.65,425.65,0,0,1-500.7,1.05l-34.21,44.4a481.83,481.83,0,0,0,569.3-1.19Z" transform="translate(-146.99 19.03)"/>
        <g class="text">
          <path d="M876,928.22l2.8.73-3.43,13.17-2.81-.74Z" transform="translate(-146.99 19.03)"/>
          <path d="M885.64,935.26l-2,8.91-2.82-.65,3.05-13.27,2.91.67,4.16,10,2-8.59,2.83.65-3.06,13.26-2.73-.62Z" transform="translate(-146.99 19.03)"/>
          <path d="M903.34,937.14l-3.91-.76.49-2.5,10.65,2.06-.48,2.51-3.89-.76-2.1,10.86-2.86-.55Z" transform="translate(-146.99 19.03)"/>
          <path d="M914.85,936.69l9.51,1.52-.4,2.46-6.64-1.06-.47,2.92,6.5,1L923,946l-6.5-1-.51,3.13,6.65,1.06-.39,2.48-9.51-1.52Z" transform="translate(-146.99 19.03)"/>
          <path d="M932.93,948.18l-2.11-.27-.61,4.84-2.87-.36,1.7-13.5,6.32.79a4.24,4.24,0,0,1,4,4.93,3.9,3.9,0,0,1-3.46,3.63l2.39,5.53-3.3-.42Zm1.69-6.08-3-.38-.47,3.73,3,.38a1.89,1.89,0,1,0,.47-3.73Z" transform="translate(-146.99 19.03)"/>
          <path d="M955.93,945.59,951.27,955l-1.26-.11-3-10.08-.83,9.75-2.89-.25,1.17-13.55,4,.35,2.57,8.73,4-8.17,4.06.35L958,955.6l-2.91-.25Z" transform="translate(-146.99 19.03)"/>
          <path d="M964.26,942.32l9.62.45-.11,2.49-6.73-.32-.14,3,6.58.31-.11,2.49-6.59-.32-.15,3.16,6.73.32-.12,2.51-9.62-.46Z" transform="translate(-146.99 19.03)"/>
          <path d="M978.59,942.92,984,943c4.27,0,7.2,2.79,7.15,6.89s-3,6.77-7.3,6.72l-5.37-.07Zm5.24,11.13a4.08,4.08,0,0,0,4.31-4.2,4,4,0,0,0-4.22-4.31l-2.47,0-.09,8.51Z" transform="translate(-146.99 19.03)"/>
          <path d="M995.76,943l2.9-.05.22,13.61-2.89.05Z" transform="translate(-146.99 19.03)"/>
          <path d="M1013,953.69,1007,954l-.75,2.38-3.18.15,4.64-13.84,3.63-.16,5.86,13.36L1014,956Zm-5.41-2.27,4.5-.21-2.52-6.13Z" transform="translate(-146.99 19.03)"/>
          <path d="M1022.3,944.38l-4,.3-.19-2.54,10.82-.83.19,2.54-3.94.3.84,11-2.9.22Z" transform="translate(-146.99 19.03)"/>
          <path d="M1033.29,940.89l9.57-1,.27,2.47-6.69.74.32,2.94,6.55-.72.27,2.47-6.55.72.35,3.14,6.69-.73.27,2.49-9.57,1Z" transform="translate(-146.99 19.03)"/>
          <path d="M1061.64,946l-2.1.34.78,4.82-2.86.46-2.17-13.44,6.28-1a4.24,4.24,0,0,1,5.22,3.6,3.92,3.92,0,0,1-2.3,4.46l3.85,4.63-3.28.53Zm-.09-6.31-3,.49.6,3.7,3-.48a1.89,1.89,0,1,0-.6-3.71Z" transform="translate(-146.99 19.03)"/>
          <path d="M1070.71,935.53l2.85-.54,2.54,13.37-2.85.54Z" transform="translate(-146.99 19.03)"/>
          <path d="M1081.34,943.13a6,6,0,0,0,4.61.88c1.56-.34,2.16-1.24,2-2-.21-1-1.44-1.08-3.06-1.11-2.28,0-5.2,0-5.84-3-.48-2.21,1-4.42,4.17-5.1a7.57,7.57,0,0,1,5.59.73l-1.13,2.42a5.76,5.76,0,0,0-4.12-.63c-1.27.27-1.83,1-1.66,1.77s1.37.94,3,1c2.3,0,5.23.07,5.87,3,.53,2.43-.81,4.64-4.4,5.42a7.87,7.87,0,0,1-6.1-.89Z" transform="translate(-146.99 19.03)"/>
          <path d="M1098.9,937.75l-.72,1.48,1,4.06-2.81.71-3.33-13.2,2.81-.7,1.48,5.89,3.18-7.07,3.46-.87-3.67,7.51,7.36,5.59-3.46.87Z" transform="translate(-146.99 19.03)"/>
        </g>
      </g>
      <g class="risk high">
        <path class="bg" d="M1415.59,503.31a424.68,424.68,0,0,1-124.77,295.06q-14.29,14.29-29.73,27.08l34.37,44.25q18.16-14.94,35-31.74A480.62,480.62,0,0,0,1471.6,503.31Z" transform="translate(-146.99 19.03)"/>
        <g class="text">
          <path d="M1380.22,741.81l-1.67,2.59-5.28-3.41-3.13,4.84,5.28,3.41-1.68,2.6-12.23-7.91,1.67-2.59,4.8,3.1,3.13-4.85-4.8-3.1,1.67-2.58Z" transform="translate(-146.99 19.03)"/>
          <path d="M1383.41,736.58,1371,729l1.6-2.65,12.46,7.54Z" transform="translate(-146.99 19.03)"/>
          <path d="M1383.77,719.84l2.85-5,6.57,3.72a16.11,16.11,0,0,1-1.84,4.92,6.39,6.39,0,0,1-4.17,3.42,8.06,8.06,0,0,1-5.69-1.23,7.33,7.33,0,0,1-3.79-4.46,7.6,7.6,0,0,1,1-5.84,10.63,10.63,0,0,1,2.91-3.32l1.64,2.11a7.39,7.39,0,0,0-2.33,2.49,4.15,4.15,0,0,0-.41,3.46,5.28,5.28,0,0,0,2.55,2.83,5.83,5.83,0,0,0,3.63.94,3.36,3.36,0,0,0,2.48-1.84,9.84,9.84,0,0,0,.8-1.81l-2.65-1.5-1.36,2.4Z" transform="translate(-146.99 19.03)"/>
          <path d="M1402,703.13l-1.41,2.74L1395,703l-2.65,5.12,5.58,2.89-1.42,2.74L1383.57,707l1.42-2.74,5.07,2.62,2.65-5.12-5.07-2.63,1.42-2.73Z" transform="translate(-146.99 19.03)"/>
          <path d="M1404.27,685.32l5.1,2.29-1.27,2.82-13.28-6,1.74-3.87a7.36,7.36,0,0,1,2.79-3.56,3.84,3.84,0,0,1,3.58.05,3.91,3.91,0,0,1,1.8,1.58,4.74,4.74,0,0,1,.6,2.47c3.89-.65,6.4-1.09,7.55-1.3l-1.41,3.13-6.52.87Zm-2.29-1,.41-.91a3.77,3.77,0,0,0,.44-2.17,1.73,1.73,0,0,0-1.11-1.27,1.57,1.57,0,0,0-1.63,0,4.22,4.22,0,0,0-1.31,1.83l-.38.85Z" transform="translate(-146.99 19.03)"/>
          <path d="M1414.52,675.86l-13.44-5.61,1.19-2.85,13.44,5.61Z" transform="translate(-146.99 19.03)"/>
          <path d="M1417.38,657.83a3.75,3.75,0,0,1,2.38,2.45,6.12,6.12,0,0,1-.37,4.09,9.2,9.2,0,0,1-2.31,3.53l-2.67-1a18.33,18.33,0,0,0,1.77-2,7.43,7.43,0,0,0,.92-1.64,2.66,2.66,0,0,0,.21-1.6,1.34,1.34,0,0,0-.89-.92,1.27,1.27,0,0,0-.79-.06,2.66,2.66,0,0,0-.86.43,19.09,19.09,0,0,0-1.6,1.4,9,9,0,0,1-1.85,1.43,4.75,4.75,0,0,1-1.64.51,3.94,3.94,0,0,1-1.81-.28,3.78,3.78,0,0,1-2.36-2.32,5.45,5.45,0,0,1,.28-3.78,8,8,0,0,1,1-1.92,14.28,14.28,0,0,1,1.48-1.74l1.88,1.8a15.15,15.15,0,0,0-1.32,1.55,6.38,6.38,0,0,0-.72,1.33,2,2,0,0,0-.11,1.4,1.36,1.36,0,0,0,.83.83,1.34,1.34,0,0,0,.73.08,2.24,2.24,0,0,0,.77-.35,18.65,18.65,0,0,0,1.66-1.46,7.68,7.68,0,0,1,2.84-1.89A3.78,3.78,0,0,1,1417.38,657.83Z" transform="translate(-146.99 19.03)"/>
          <path d="M1426.83,643.4l-1.16,3.31-7.06,1.57.45,1.54,4.91,1.72-1,2.92-13.74-4.83,1-2.92,6.29,2.21-1.22-1.71-3.36-5.37,1.14-3.23,4.39,6.93Z" transform="translate(-146.99 19.03)"/>
        </g>
      </g>
    </g><!-- risk-options -->

    <g id="guys">
      <g class="guy" data-show-risk="high">
        <path id="stool" d="M976.71,570.43h6a6.74,6.74,0,1,0,0-13.48H878.88a6.74,6.74,0,0,0,0,13.48h5.23l-25.42,164,13.56,2.1,7.58-48.92H981l7.58,48.92,13.56-2.1ZM882.23,672.15,898,570.43h64.82l15.77,101.72Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <circle id="head" cx="841.57" cy="339.39" r="45.39" style="fill: #d7d7d7"/>
        <path id="arm" d="M1072.4,519.89a17.12,17.12,0,0,1-21.11,11.83L974.39,509l-.61-.18a17.15,17.15,0,0,1-12.24-10.29l-33.61-83.66a17.17,17.17,0,0,1,9.45-22.28,17,17,0,0,1,6.36-1.24A17.18,17.18,0,0,1,959.66,402l30.45,75.82,70.46,20.93A17.15,17.15,0,0,1,1072.4,519.89Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <path d="M893.64,543.13c-2.23-4-3.67-8-3.78-11A84.78,84.78,0,0,0,893.64,543.13Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <path d="M1071.34,531.44v.33a23.59,23.59,0,0,1-.13,2.42,38.53,38.53,0,0,1-.61,4l-.88,3.73-30,127.5a26.6,26.6,0,1,1-51.81-12.12l21.9-93.65h-93c-7.29,0-17.6-10.6-23.09-20.51a84.78,84.78,0,0,1-3.78-11c-3.33-12.18-4.36-25.19-4.79-37.58a255,255,0,0,1,4.75-59.51c3.69-18.18,9.22-37.07,22.45-50.74,12.16-12.57,36.38-25,52.73-13.08a28.07,28.07,0,0,1,10,15.08c2.21,7.6,2.19,24.52.92,43.76-4.87-12.05-9.39-23.22-11.75-29.07a21.65,21.65,0,0,0-1.05-2.64,16.42,16.42,0,0,0-4.42-6.11A21.56,21.56,0,0,0,922.17,407c0,.22,0,.45,0,.68v.15q0,.48,0,1c0,.31,0,.62.07.92s0,.48.08.71c.46,3.49,2,6.34,3.3,9.54,1.47,3.55,2.87,7.15,4.31,10.72L935.31,444q3.09,7.68,6.19,15.34t6.22,15.4q2.73,6.73,5.45,13.48l3.85,9.54,1.47,3.63a18.21,18.21,0,0,0,4.39,6.43v3.84h6c.38.11,2.48.76,2.87.84l.66.19,81.22,22.89a18.4,18.4,0,0,0,17.73-4.43C1071.33,531.24,1071.34,531.34,1071.34,531.44Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
      </g>
      <g class="guy" data-show-risk="intermediate">
        <path id="leg" d="M941.43,527.1l35.34,34.41-38.71,67.21-2.95,4L882,705.08a23.89,23.89,0,0,1-38.13-28.78L896,606.22c.27-.55.56-1.09.87-1.63Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <path id="body" d="M1094,715.59A23.85,23.85,0,0,1,1063.55,701l-33.66-95.4-46.15-44.17-.1-.1-39.93-38.87,0-113.48-45.37,26.27-6.39,72.84A19.5,19.5,0,0,1,853.06,506a20.41,20.41,0,0,1,.12-2.2l7.7-81.87c0-.07,0-.13,0-.2l0-.47a19.42,19.42,0,0,1,9.63-15L948,359.36a9.07,9.07,0,0,1,5.73-1.44h21.74A35.69,35.69,0,0,1,1011,393.51v38.55l69.73,59.71A19.89,19.89,0,1,1,1054.86,522L1011,486v29.76l57,60.51a17.85,17.85,0,0,1,2.44,3,25.21,25.21,0,0,1,1.82,4.59l36.35,101.23A23.88,23.88,0,0,1,1094,715.59Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <circle id="head-2" data-name="head" cx="835.3" cy="322.06" r="43.07" style="fill: #d7d7d7"/>
      </g>
      <g class="guy" data-show-risk="low">
        <g id="wind">
          <path d="M740.56,603.65a3.65,3.65,0,0,1-3.65,3.65H685.65a3.64,3.64,0,0,1-2.57-6.22,3.6,3.6,0,0,1,2.57-1.08h51.26A3.66,3.66,0,0,1,740.56,603.65Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
          <path d="M1079.56,649.65a3.69,3.69,0,0,1-1,2.58,3.42,3.42,0,0,1-2.48,1.07h-49.31a3.59,3.59,0,0,1-3.5-3.65,3.72,3.72,0,0,1,1-2.57,3.4,3.4,0,0,1,2.47-1.08h49.31A3.6,3.6,0,0,1,1079.56,649.65Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
          <path d="M1101.56,670.65a3.56,3.56,0,0,1-1.12,2.58,3.88,3.88,0,0,1-2.69,1.07h-53.51a3.74,3.74,0,0,1-3.8-3.65,3.55,3.55,0,0,1,1.12-2.57,3.84,3.84,0,0,1,2.68-1.08h53.51A3.75,3.75,0,0,1,1101.56,670.65Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
          <rect x="584.34" y="596.04" width="49.22" height="7.29" rx="3.34" style="fill: #d7d7d7"/>
          <rect x="547.62" y="514.04" width="96.95" height="7.29" rx="3.65" style="fill: #d7d7d7"/>
          <rect x="580.88" y="484.04" width="100.68" height="7.29" rx="3.65" style="fill: #d7d7d7"/>
          <rect x="523.88" y="461.04" width="100.68" height="7.29" rx="3.65" style="fill: #d7d7d7"/>
          <rect x="608.25" y="408.04" width="78.32" height="7.29" rx="3.22" style="fill: #d7d7d7"/>
          <rect x="917.79" y="708.04" width="31.77" height="7.3" rx="3.65" style="fill: #d7d7d7"/>
        </g>
        <path id="leg-back" d="M880.42,565.89a.47.47,0,0,1-.12.28c-4.74,6.82-9.51,13.64-14.11,20.55L852,607.43l-8.09,11.79-.16.24c-.08.14-.18.25-.26.38l-.12.17a20.93,20.93,0,0,1-1.73,2.3l-.44.51c-.28.31-.57.6-.87.89l-.66.61c-.27.24-.54.49-.82.71a16.91,16.91,0,0,1-1.6,1.18,21.74,21.74,0,0,1-4.57,2.3l-.65.24-.1,0-76.33,27.73a21.69,21.69,0,0,1-27.7-12.94l-.18-.48a21.7,21.7,0,0,1,12.94-27.71l69.76-25.33,29.46-48.53c7.93,10.5,22.31,17.1,35,17.65.51,0,4.57,5.28,5.43,6.42A.52.52,0,0,1,880.42,565.89Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <path id="leg-front" d="M974.37,712.22a22.88,22.88,0,0,1-3.75.32,22.48,22.48,0,0,1-22.09-18.62l-13.4-78.47-54.79-58a22.38,22.38,0,0,1,32.55-30.73l58.2,61.65h0a22.24,22.24,0,0,1,7,12.75l14.58,85.29A22.46,22.46,0,0,1,974.37,712.22Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <path id="arm-2" data-name="arm" d="M1015.36,474.53a19.29,19.29,0,0,1-19.22,19.22H919.51a18.89,18.89,0,0,1-5.9-.94l-.69-.23a19.14,19.14,0,0,1-10.64-9l-42.07-78.29a19.29,19.29,0,0,1,7.84-26.05,19,19,0,0,1,9.05-2.28,19.29,19.29,0,0,1,17,10.12l36.7,68.27h65.34A19.28,19.28,0,0,1,1015.36,474.53Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <g id="cart">
          <path d="M1136.43,660.36a25.35,25.35,0,1,0,25.35,25.35A25.35,25.35,0,0,0,1136.43,660.36Zm0,38.54a13.19,13.19,0,1,1,13.18-13.19A13.19,13.19,0,0,1,1136.43,698.9Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
          <path d="M1202.43,660.36a25.35,25.35,0,1,0,25.35,25.35A25.35,25.35,0,0,0,1202.43,660.36Zm0,38.54a13.19,13.19,0,1,1,13.18-13.19A13.19,13.19,0,0,1,1202.43,698.9Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
          <path d="M1254,603.56H1106.66L1121,639.41h101.31a8.65,8.65,0,1,1,0,17.29h-113.9l-6.89-17.29-63.88-160.26h-16.31a21.24,21.24,0,0,0-4.69-20.74h32.22l8.27,20.74,9.87,24.76H1267Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        </g>
        <path id="body-2" data-name="body" d="M918,499a24.21,24.21,0,0,1-22.52-15.5l-40.77-76.88a24.79,24.79,0,0,1,10.07-33.48,24.49,24.49,0,0,1,11.64-2.93,24.78,24.78,0,0,1,21.85,13l35.11,65.34h.26l3.58-39.18a48,48,0,0,0-43.28-52l-.88-.08a48,48,0,0,0-52,43.29L832,500.21a48,48,0,0,0,43.29,52l.88.08a48,48,0,0,0,52-43.29l.91-10Z" transform="translate(-146.99 19.03)" style="fill: #d7d7d7"/>
        <circle id="head-3" data-name="head" cx="760.76" cy="319.54" r="41.5" style="fill: #d7d7d7"/>
      </g>
    </g><!-- guys -->

    <g id="info-titles">
      <text class="node echo" transform="translate(-10 371.52)">ECHOCARDIOGRAM</text>
      <text class="node functional" transform="translate(63.1 230.91)">FUNCTIONAL CLASS</text>
      <text class="node six-minute" transform="translate(137.11 73.79)">SIX-MINUTE WALK TEST<tspan x="279.14" y="43.2">(6MWT)</tspan></text>
      <text class="node cardio" transform="translate(1120.13 73.79)">CARDIOPULMONARY<tspan x="0" y="43.2">EXERCISE TESTING (CPET)</tspan></text>
      <text class="node haemo" transform="translate(1258.48 230.91)">HAEMODYNAMICS</text>
      <text class="node nt-pro" transform="translate(1339.01 371.52)">NT-pro BNP<tspan x="0" y="43.2">PLASMA LEVELS</tspan></text>
      <text class="node nt-pro bottom" transform="translate(1339.01 449.52)">(used to help detect, diagnose, and<tspan x="0" y="25.2">evaluate the severity of heart failure)</tspan></text>
    </g><!-- info-titles -->

    <g id="branches">
      <g class="echo">
        <polyline class="branch" points="505.13 434.85 401.02 358.56 372.02 358.56"/>
        <circle class="dot" cx="372.02" cy="358.56" r="5.85" />
        <circle class="halo" cx="372.02" cy="358.56" r="16.67"/>
      </g>
      <g class="functional">
        <polyline class="branch" points="563.94 309.24 481.56 217.91 452.56 217.91"/>
        <circle class="dot" cx="452.56" cy="217.91" r="5.85"/>
        <circle class="halo" cx="452.56" cy="217.91" r="16.67"/>
      </g>
      <g class="six-minute">
        <polyline class="branch" points="687.48 205.62 617.27 61.4 588.27 61.4"/>
        <circle class="dot" cx="588.27" cy="61.4" r="5.85"/>
        <circle class="halo" cx="588.27" cy="61.4" r="16.67"/>
      </g>
      <g class="cardio">
        <polyline class="branch" points="997.53 205.62 1067.74 61.4 1067.74 61.4 1096.74 61.4"/>
        <circle class="dot" cx="1096.74" cy="61.4" r="5.85"/>
        <circle class="halo" cx="1096.74" cy="61.4" r="16.67"/>
      </g>
      <g class="haemo">
        <polyline class="branch" points="1121.08 309.24 1203.45 217.91 1232.45 217.91"/>
        <circle class="dot" cx="1232.45" cy="217.91" r="5.85"/>
        <circle class="halo" cx="1232.45" cy="217.91" r="16.67"/>
      </g>
      <g class="nt-pro">
        <polyline class="branch" points="1179.88 434.85 1283.99 358.56 1312.99 358.56"/>
        <circle class="dot" cx="1312.99" cy="358.56" r="5.85"/>
        <circle class="halo" cx="1312.99" cy="358.56" r="16.67"/>
      </g>
    </g><!-- branches -->

    <g id="stateful-messages">
      <text data-show-info="echo" class="echo" data-name="echo" transform="translate(585.04 375.52)">An echocardiogram is a picture of the heart.<tspan style="letter-spacing: 0.010009765625em"><tspan x="30.58" y="31.2">It measures the size and shape of your</tspan><tspan x="-1.78" y="62.4">heart, and how well it squeezes and relaxes.</tspan><tspan x="18.82" y="124.8">Helps monitor </tspan><tspan x="189.04" y="124.8" style="letter-spacing: -0.06698843149038461em">P</tspan><tspan x="202.56" y="124.8" style="letter-spacing: 0.009990985576923076em">AH, and shows how your</tspan><tspan x="64.88" y="156">heart is responding to treatment.</tspan></tspan></text>
      <text data-show-info="functional" class="functional" data-name="functional" transform="translate(588.7 375.52)">Functional Class is one way to describe the<tspan style="letter-spacing: 0.010009765625em"><tspan x="17.99" y="31.2">severity of </tspan><tspan x="145.68" y="31.2" style="letter-spacing: -0.06698843149038461em">P</tspan><tspan x="159.2" y="31.2" style="letter-spacing: 0.009990985576923076em">AH, can range from 1-4, with</tspan><tspan x="10.69" y="62.4">more severe symptoms equaling a higher</tspan></tspan><tspan x="158.84" y="93.6">functional class.</tspan><tspan x="33.99" y="148.8">Because functional class may change</tspan><tspan style="letter-spacing: 0.010009765625em"><tspan x="52.43" y="180">over tim</tspan><tspan x="146.55" y="180" style="letter-spacing: 0.0030235877403846155em">e</tspan><tspan x="161.26" y="180" style="letter-spacing: 0.009990985576923076em">, it</tspan><tspan x="188.48" y="180" style="letter-spacing: -0.020000751201923076em">’</tspan><tspan x="193.94" y="180" style="letter-spacing: 0.009990985576923076em">s important to monitor</tspan></tspan></text>
      <text data-show-info="six-minute" class="six-minute" data-name="six-minute" transform="translate(687.48 375.52)">Measures how far you can<tspan style="letter-spacing: 0.009990985576923076em"><tspan x="51.49" y="31.2">walk in 6 minutes</tspan></tspan><tspan x="-27.98" y="93.6">Helps determine how well your</tspan><tspan x="33.79" y="124.8">treatment is working</tspan></text>
      <text data-show-info="cardio" class="cardio" data-name="cardio" transform="translate(613.64 375.52)">Measures how much air your lungs can<tspan x="-6.69" y="31.2">hold, and how much and how quickly air</tspan><tspan x="126.5" y="62.4">moves in and out</tspan><tspan x="1.99" y="124.8">Helps identify issues with the structure</tspan><tspan x="16.16" y="156">and function of your heart and lungs</tspan></text>
      <text data-show-info="haemo" class="haemo" data-name="haemo" transform="translate(703.55 375.52)">Measures blood flow or<tspan style="letter-spacing: 0.009990985576923076em"><tspan x="0.75" y="31.2">circulation in your body</tspan></tspan><tspan x="-72.94" y="93.6">Provides insight about how the right</tspan><tspan style="letter-spacing: 0.009990985576923076em"><tspan x="-72" y="124.8">ventricle of your heart is functioning</tspan></tspan></text>
      <text data-show-info="nt-pro" class="nt-pro" data-name="nt-pro" transform="translate(614.51 335.52)">Measures the amount of BNP hormone<tspan x="-19.81" y="31.2">in your blood. BNP is produced when your</tspan><tspan x="-25.62" y="62.4">heart is under stress. If it wor</tspan><tspan x="309.33" y="62.4" style="letter-spacing: 0.004000150240384615em">k</tspan><tspan x="322.8" y="62.4">s harder than</tspan><tspan x="56.81" y="93.6">normal, it releases more BNP</tspan><tspan x="-18.16" y="156">Provides information about how hard your</tspan><tspan x="-19.56" y="187.2">heart is working and about how your body</tspan><tspan x="72.12" y="218.4">is responding to treatment</tspan></text>
    </g><!-- stateful-message -->

    <g id="stateful-result">
      <g class="low" data-show-risk="low">
        <text data-show-info="echo" class="echo" transform="translate(723.56 701.5)">RA area &lt; 18cm²<tspan x="-73.33" y="38.4">No fluid around your heart</tspan><tspan x="-53.65" y="76.8">(no pericardial effusion)</tspan></text>
        <text data-show-info="functional" class="functional" transform="translate(669.22 701.5)">Class I - Symptoms with<tspan x="43.44" y="38.4">ordinary activities</tspan></text>
        <text data-show-info="six-minute" class="six-minute" transform="translate(786.55 701.5)">&gt;440 m</text>
        <text data-show-info="cardio" class="cardio" transform="translate(662.63 701.5)">Peak VO₂ &gt;15 mL/min/kg<tspan x="88.06" y="38.4">(&gt;65% pred.)</tspan><tspan x="38.54" y="76.8">VE/VCO₂ slope &lt;36</tspan></text>
        <text data-show-info="haemo" class="haemo" transform="translate(731.78 701.5)">RAP &lt;8 mm Hg<tspan x="-11.3" y="38.4">CI ≥2.5 L/min/m²</tspan><tspan x="29.57" y="76.8">SvO₂ &gt;65%</tspan></text>
        <text data-show-info="nt-pro" class="nt-pro" transform="translate(745.78 701.5)">BNP &lt;50 ng/L<tspan x="-60.3" y="38.4">NT-pro BNP &lt;300 ng/L</tspan></text>
      </g>
      <g class="intermediate" data-show-risk="intermediate">
        <text data-show-info="echo" class="echo" transform="translate(707.49 701.5)">RA area 18-26 cm²<tspan x="-3.54" y="38.4">No or minimal fluid</tspan><tspan x="3.74" y="76.8">around your heart</tspan></text>
        <text data-show-info="functional" class="functional" transform="translate(610.19 701.5)">Class II - Symptoms with ordinary activity.<tspan x="81.59" y="28.8">Slight limitation of activity.</tspan><tspan x="21.18" y="57.6">Or Class III - Symptoms with less than</tspan><tspan x="37.56" y="86.4">ordinary activity. Marked limitation</tspan><tspan x="169.87" y="115.2">of activity.</tspan></text>
        <text data-show-info="six-minute" class="six-minute" transform="translate(763.78 701.5)">165-440 m</text>
        <text data-show-info="cardio" class="cardio" transform="translate(652.74 701.5)">Peak VO₂ 11-15 mL/min/kg<tspan x="82.1" y="38.4">(35-65% pred.)</tspan><tspan x="18.77" y="76.8">VE/VCO₂ slope 36-44.9</tspan></text>
        <text data-show-info="haemo" class="haemo" transform="translate(718.92 701.5)">RAP 8-14 mm Hg<tspan x="-18.61" y="38.4">CI 2.0-2.4 L/min/m²</tspan><tspan x="26.05" y="76.8">S</tspan><tspan x="45.02" y="76.8">vO₂ 60-65%</tspan></text>
        <text data-show-info="nt-pro" class="nt-pro" transform="translate(714.98 701.5)">BNP 50-300 ng/L<tspan x="-69.53" y="38.4">NT-pro BNP 300-1400 ng/L</tspan></text>
      </g>
      <g class="high" data-show-risk="high">
        <text data-show-info="echo" class="echo" transform="translate(720.5 700.5)">RA area &gt;26 cm²<tspan x="-49.23" y="38.4">Fluid around your heart</tspan></text>
        <text data-show-info="functional" class="functional" transform="translate(658.28 701.5)">Class IV - Symptoms with<tspan x="10.78" y="38.4">any activity or even rest</tspan></text>
        <text data-show-info="six-minute" class="six-minute" transform="translate(789.54 701.5)">&lt;165 m</text>
        <text data-show-info="cardio" class="cardio" transform="translate(665.78 700.5)">Peak VO₂ &lt;11 mL/min/kg<tspan x="85.25" y="38.4">(&lt;35% pred.)</tspan><tspan x="31.14" y="76.8">VE/VCO₂ slope ≥45</tspan></text>
        <text data-show-info="haemo" class="haemo" transform="translate(729.44 700.5)">RAP &gt;14mm Hg<tspan x="-9.15" y="38.4">CI &lt;2.0 L/min/m²</tspan><tspan x="31.71" y="76.8" style="letter-spacing: -0.006988525390625em">SvO₂ &lt;60%</tspan></text>
        <text data-show-info="nt-pro" class="nt-pro" transform="translate(731.36 700.5)">BNP &gt;300 ng/L<tspan x="-55.85" y="38.4">NT-pro BNP &gt;1400ng/L</tspan></text>
      </g>
    </g><!-- stateful-result -->

    <text id="results-range" transform="translate(754.82 627.66)">Results Range</text>
    <text id="key" transform="translate(406.8 1106.14)">BNP = Brain Natriuretic Peptides; NT-pro BNP = N-terminal pro b-type</text>
  </svg>
</template>

<script>
import { Machine, interpret } from 'xstate';
import { TweenMax, Draggable } from 'gsap/all';
import ThrowPropsPlugin from '../vendor/gsap/ThrowPropsPlugin';

export default {
  data() {
    return {
      riskMachine: Machine({
        id: 'risky',
        type: 'parallel',
        states: {
          risk: {
            initial: 'low',
            states: {
              low: {
                on: {
                  INIT_INTERMEDIATE: 'intermediate',
                  INIT_HIGH: 'high',
                }
              },
              intermediate: {
                on: {
                  INIT_LOW: 'low',
                  INIT_HIGH: 'high',
                }
              },
              high: {
                on: {
                  INIT_LOW: 'low',
                  INIT_INTERMEDIATE: 'intermediate',
                }
              },
            }
          },
          info: {
            initial: 'echo',
            states: {
              echo: {
                on: {
                  SELECT_FUNCTIONAL: 'functional',
                  SELECT_SIX_WALK: 'six-minute',
                  SELECT_CARDIO: 'cardio',
                  SELECT_HAEMO: 'haemo',
                  SELECT_NT_PRO: 'nt-pro'
                }
              },
              functional: {
                on: {
                  SELECT_ECHO: 'echo',
                  SELECT_SIX_WALK: 'six-minute',
                  SELECT_CARDIO: 'cardio',
                  SELECT_HAEMO: 'haemo',
                  SELECT_NT_PRO: 'nt-pro'   
                }
              },
              'six-minute': {
                on: {
                  SELECT_ECHO: 'echo',
                  SELECT_FUNCTIONAL: 'functional',
                  SELECT_CARDIO: 'cardio',
                  SELECT_HAEMO: 'haemo',
                  SELECT_NT_PRO: 'nt-pro'
                }
              },
              cardio: {
                on: {
                  SELECT_ECHO: 'echo',
                  SELECT_FUNCTIONAL: 'functional',
                  SELECT_SIX_WALK: 'six-minute',
                  SELECT_HAEMO: 'haemo',
                  SELECT_NT_PRO: 'nt-pro'            
                }
              },
              haemo: {
                on: {
                  SELECT_ECHO: 'echo',
                  SELECT_FUNCTIONAL: 'functional',
                  SELECT_SIX_WALK: 'six-minute',
                  SELECT_CARDIO: 'cardio',
                  SELECT_NT_PRO: 'nt-pro'
                }
              },
              'nt-pro': {
                on: {
                  SELECT_ECHO: 'echo',
                  SELECT_FUNCTIONAL: 'functional',
                  SELECT_SIX_WALK: 'six-minute',
                  SELECT_CARDIO: 'cardio',
                  SELECT_HAEMO: 'haemo'
                }
              }
            }
          }
        }
      }),
      service: null,
      canvas: null,
      arrowPath: null,
      arrow: null,
      nodes: null,
    }
  },
  mounted() {
    this.service = interpret(this.riskMachine)
      .onTransition(this.activate);


    this.activate(this.riskMachine.initialState)
    this.service.start()

    this.canvas = this.$refs.canvas;
    this.arrowPath = this.$refs.arrow;
    this.arrow = this.$refs.arrowShape;

    TweenMax.set(this.arrowPath, {transformOrigin: 'center center'})
    TweenMax.set(this.canvas, {visibility: 'visible'});
    TweenMax.to(this.arrowPath, 0.5, {rotation: 65})

    Draggable.create(this.arrowPath, {
      type:'rotation',
      bounds: {minRotation: -65, maxRotation: 65},
      trigger: this.arrow,
      overshootTolerance: 0.05,
      maxDuration: 0.5,
      throwProps: true,
      snap: function(endValue) {
        return Math.round(endValue / 65) * 65;
      },
      onThrowComplete: () => this.setRiskOnDrag()
    });

    document.querySelectorAll('#info-titles text').forEach(node => {
      node.addEventListener('click', () => {
        this.setInfo(node.classList[1]);
      })
    })

      document.querySelectorAll('.risk').forEach(risk => {
      risk.addEventListener('click', () => {
        this.setRiskOnSelect(risk.classList[1])
      })
    })
  },
  methods: {
    activate(state) {
      document.querySelector('#canvas').dataset.risk = state.value.risk
      document.querySelector('#canvas').dataset.info = state.value.info

      // When the overall state matches a [data-show="..."] state, the element should have the data-active attribute.
      document.querySelectorAll('#canvas [data-active]').forEach(el => {
        el.removeAttribute('data-active')
      })

      document.querySelectorAll(`#canvas [data-show-risk~="${state.value.risk}"]`).forEach(el => {
        el.setAttribute('data-active', true)
      })

      document.querySelectorAll(`#canvas [data-show-info~="${state.value.info}"]`).forEach(el => {
        el.setAttribute('data-active', true)
      })
    },
    setRiskOnDrag() {
      switch(this.arrowPath._gsTransform.rotation) {
        case -65:
          this.service.send('INIT_HIGH');
          break;
        case 0:
          this.service.send('INIT_INTERMEDIATE');
          break;
        case 65:
          this.service.send('INIT_LOW');
          break;
        default:
          console.log('oh no');
      }
    },
    setRiskOnSelect(risk) {
      switch(risk) {
        case 'low':
          TweenMax.to(this.arrowPath, 0.5, {rotation: 65});
          this.service.send('INIT_LOW');
          break;
        case 'intermediate':
          TweenMax.to(this.arrowPath, 0.5, {rotation: 0});
          this.service.send('INIT_INTERMEDIATE');
          break;
        case 'high':
          TweenMax.to(this.arrowPath, 0.5, {rotation: -65});
          this.service.send('INIT_HIGH');
          break;
        default:
          console.log('oh no!');
      }
    },
    setInfo(section) {
      switch(section) {
        case 'echo':
          this.service.send('SELECT_ECHO');
          break;
        case 'functional':
          this.service.send('SELECT_FUNCTIONAL');
          break;
        case 'six-minute':
          this.service.send('SELECT_SIX_WALK');
          break;
        case 'cardio':
          this.service.send('SELECT_CARDIO');
          break;
        case 'haemo':
          this.service.send('SELECT_HAEMO');
          break;
        case 'nt-pro':
          this.service.send('SELECT_NT_PRO');
          break;
        default:
          console.log('oh no!');
      }
    },
  }
}
</script>

<style lang="scss" scoped>
@import url("https://use.typekit.net/vje7yoc.css");

#canvas {
  --color-low: #21A84A;
  --color-intermediate: #F57D1F;
  --color-high: #ED1F24;

  width: 100%;
  visibility: hidden;
  font-family: 'Proxima Nova', sans-serif;
}

[data-show-info],
[data-show-risk] {
  opacity: 0;

  &[data-active] {
    opacity: 1;
  }
}

/* TRANSITIONS
=========================================== */

#guys .guy,
#stateful-messages text,
#stateful-result g,
#stateful-result text {
  transition: opacity 300ms ease-in-out;
}

#main-elements #outer,
#info-titles .node {
  transition: fill 300ms ease-in-out;
}

#branches .branch,
#branches .halo {
  transition: stroke 300ms ease-in-out;
}

/* ELEMENTS
=========================================== */

#main-elements #inner {
  fill: #e7e7e9;
  stroke: #8f9194;
  stroke-width: 3px;
}

#main-elements #outer {
  fill: none;
  stroke-width: 4px;
  stroke: #8f9194;
}

/* ARROW
=========================================== */

#arrow circle {
  visibility: hidden;
}

#arrow polygon {
  fill: #8f9194;
  transition: fill 300ms ease-in-out;
  cursor: pointer;
}

/* RISK OPTIONS
=========================================== */

#risk-options .risk {
  cursor: pointer;
}

#risk-options .risk .bg {
  fill: #e7e7e9;
  transition: fill 300ms ease-in-out;
}

#risk-options .risk .text {
  font-size: 20px;
  font-weight: 700;
  fill: #5C5C5E;
  user-select: none;
  transition: fill 300ms ease-in-out;
}

/* GUYS
=========================================== */

#guys .guy {
  fill: #d7d7d7;
}

/* INFO TITLES
=========================================== */

#info-titles text {
  cursor: pointer;
  font-size: 36px;
  fill: #8f9194;
  font-weight: 700;

}

#info-titles text {
  font-size: 36px;
  font-weight: 700;
}

#info-titles .node.nt-pro.bottom {
  font-size: 21px;
}

/* BRANCHES
=========================================== */

#branches .branch {
  stroke: #8f9194;
  fill: none;
  stroke-width: 1px;
  transition: stroke 300ms ease-in-out;
}

#branches .halo {
  fill: none;
  stroke: transparent;
  stroke-width: 1px;
}

#branches .dot {
  fill: #8f9194;
  transition: fill 300ms ease-in-out;
}

/* INFO STATEFUL MESSAGES
=========================================== */
#stateful-messages {
  font-size: 26px;
}


/* INFO STATEFUL RESULT
=========================================== */

#stateful-result text {
  font-size: 32px;
  font-weight: 700;
}

#stateful-result .low {
  fill: var(--color-low);
}

#stateful-result .intermediate {
  fill: var(--color-intermediate);
}

#stateful-result .intermediate .functional {
  font-size: 24px;
}

#stateful-result .high {
  fill: var(--color-high);
}

/* STATIC TEXT
=========================================== */

#results-range {
  font-size: 26px;
  font-weight: 700;
}

#key {
  font-size: 26px;
}

/* RISK STATES
=========================================== */

[data-risk~="low"] {
  --bg: var(--color-low);
  --color: #fff;
  #main-elements #outer {
    stroke: var(--bg);
  }

  #arrow polygon {
    fill: var(--bg);
  }

  #risk-options .risk.low .bg {
    fill: var(--bg);
  }

  #risk-options .risk.low .text {
    fill: var(--color);
  }
}

[data-risk~="intermediate"] {
  --bg: var(--color-intermediate);
  --color: #fff;
  #main-elements #outer {
    stroke: var(--bg);
  }

  #arrow polygon {
    fill: var(--bg);
  }

  #risk-options .risk.intermediate .bg {
    fill: var(--bg);
  }

  #risk-options .risk.intermediate .text {
    fill: var(--color);
  }
}

[data-risk~="high"] {
  --bg: var(--color-high);
  --color: #fff;
  #main-elements #outer {
    stroke: var(--bg);
  }

  #arrow polygon {
    fill: var(--bg);
  }

  #risk-options .risk.high .bg {
    fill: var(--bg);
  }

  #risk-options .risk.high .text {
    fill: var(--color);
  }
}

/* INFO STATES
=========================================== */

[data-info~="echo"] {
  #info-titles .echo {
    fill: var(--bg);
  }

  #branches .echo .dot {
    fill: var(--bg);
  }
  
  #branches .echo .branch,
  #branches .echo .halo {
    stroke: var(--bg);
    transform: scale(1);
  }
}

[data-info~="functional"] {
  #info-titles .functional {
    fill: var(--bg);
  }

  #branches .functional .dot {
    fill: var(--bg);
  }
  
  #branches .functional .branch,
  #branches .functional .halo {
    stroke: var(--bg);
  }
}

[data-info~="six-minute"] {
  #info-titles .six-minute {
    fill: var(--bg);
  }

  #branches .six-minute .dot {
    fill: var(--bg);
  }
  
  #branches .six-minute .branch,
  #branches .six-minute .halo {
    stroke: var(--bg);
  }
}

[data-info~="cardio"] {
  #info-titles .cardio {
    fill: var(--bg);
  }

  #branches .cardio .dot {
    fill: var(--bg);
  }
  
  #branches .cardio .branch,
  #branches .cardio .halo {
    stroke: var(--bg);
  }
}

[data-info~="haemo"] {
  #info-titles .haemo {
    fill: var(--bg);
  }

  #branches .haemo .dot {
    fill: var(--bg);
  }
  
  #branches .haemo .branch,
  #branches .haemo .halo {
    stroke: var(--bg);
  }
}

[data-info~="nt-pro"] {
  #info-titles .nt-pro {
    fill: var(--bg);
  }

  #branches .nt-pro .dot {
    fill: var(--bg);
  }
  
  #branches .nt-pro .branch,
  #branches .nt-pro .halo {
    stroke: var(--bg);
  }
}
</style>